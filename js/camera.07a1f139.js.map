{"version":3,"sources":["webpack:///./src/views/camera/main.vue?cd05","webpack:///./src/views/camera/camera.vue?5155","webpack:///./src/assets/111.png","webpack:///./src/views/camera/camera.vue?38c1","webpack:///./src/views/camera/main.vue","webpack:///./src/views/camera/camera.vue","webpack:///./src/views/camera/camera.vue?6ad1","webpack:///./src/views/camera/main.vue?bf43"],"names":["module","exports","class","src","id","alt","takePhoto","readTake","type","accept","capture","chooseImg","$event","autoplay","isTake","reTake","submit","rate","showK","currPhoto","components","computed","this","getMedia","methods","undefined","navigator","mediaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","Promise","resolve","reject","call","audio","video","then","stream","document","querySelector","srcObject","window","URL","createObjectURL","onloadedmetadata","e","play","videoHeight","videoWidth","catch","err","getElementById","canvas","ctx","getContext","canvasWidth","screen","width","canvasHeight","setAttribute","clearRect","drawImage","toDataURL","$nextTick","render","__scopeId","isCamera1","isIos","isSuport","camera","u","userAgent","match","obj","target","files","length","file","reader","FileReader","readAsDataURL","onload","currentTarget","result","click"],"mappings":"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","file":"js/camera.07a1f139.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./main.vue?vue&type=style&index=0&id=710c53d4&scoped=true&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./camera.vue?vue&type=style&index=1&id=40913e63&scoped=true&lang=css\"","module.exports = __webpack_public_path__ + \"img/111.aa2c830b.png\";","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./camera.vue?vue&type=style&index=0&id=40913e63&lang=css\"","<!-- 实名认证页面 -->\r\n<template>\r\n  <div class=''>\r\n    <div>\r\n      <button @click=\"takePhoto\">上传</button>\r\n    </div>\r\n    <div v-if=\"readTake\" :class=\"{startTake:readTake}\">\r\n      <div v-if=\"isCamera1\">\r\n        <camera></camera>\r\n      </div>\r\n      <div v-else>\r\n        <input id=\"takepicture\" type=\"file\" accept=\"image/*\" capture=\"camera\" @change=\"chooseImg($event)\">\r\n        <img src=\"\" id=\"img\" alt=\"\" />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport camera from './camera'\r\nexport default {\r\n  data() {\r\n    return {\r\n      readTake: false,\r\n      isCamera1: false,\r\n      isIos: false,\r\n      isSuport: false,\r\n    };\r\n  },\r\n\r\n  components: { camera },\r\n\r\n  computed: {},\r\n\r\n\r\n  created() {\r\n    //判断是否ios\r\n    var u = navigator.userAgent;\r\n    this.isIos = !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端 },\r\n    // 判断是否支持自定义相机 \r\n    if (navigator.mediaDevices || navigator.webkitGetUserMedia || navigator.mozGetUserMedia) {\r\n      this.isSuport = true\r\n    }\r\n  },\r\n  // mounted() { },\r\n\r\n  methods: {\r\n    chooseImg(obj) {\r\n      if (obj.target.files.length == 0) return\r\n      var file = obj.target.files[0];\r\n      var reader = new FileReader();\r\n      reader.readAsDataURL(file);\r\n      reader.onload = function (e) {\r\n        document.getElementById('img').src = e.currentTarget.result;\r\n      };\r\n    },\r\n    takePhoto() {\r\n      this.readTake = true\r\n      this.$nextTick(() => {\r\n        // 如果是ios或者不支持mediaDevices，走原始相机\r\n        if (this.isIos || !this.isSuport) {\r\n          this.isCamera1 = false\r\n          this.$nextTick(() => {\r\n            document.getElementById('takepicture').click()\r\n          })\r\n        } else {\r\n          this.isCamera1 = true\r\n        }\r\n      })\r\n    },\r\n\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.startTake {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  z-index: 99999;\r\n}\r\n</style>","<!--  -->\r\n<template>\r\n  <div class='bg_black'>\r\n    <div>\r\n      <div class=\"box\" v-if=\"!isTake\">\r\n        <video id=\"video\" autoplay=\"autoplay\"></video>\r\n        <img v-if=\"showK\" src=\"@/assets/111.png\" alt=\"\" id=\"kuan\" />\r\n        <button class=\"take_phone\" @click=\"takePhoto\">拍照</button>\r\n      </div>\r\n      <div class=\"img_box\" v-if=\"isTake\">\r\n        <img src=\"\" id=\"img\" alt=\"\" />\r\n        <div class=\"tools\">\r\n          <button class=\"re_take\" @click=\"reTake\">重拍</button>\r\n          <button class=\"confirm\" @click=\"submit\">确定</button>\r\n        </div>\r\n      </div>\r\n      <canvas id=\"canvas\"></canvas>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      rate: 0.75,\r\n      isTake: false,\r\n      showK: false,\r\n      currPhoto: null,\r\n    };\r\n  },\r\n  components: {},\r\n  computed: {},\r\n  mounted() {\r\n    this.getMedia()\r\n  },\r\n  methods: {\r\n    // 唤起摄像机\r\n    getMedia() {\r\n      let constraints = {\r\n        video: {\r\n          width: 480,\r\n          height: 360,\r\n          facingMode: { exact: \"environment\" }\r\n        },\r\n        audio: false,\r\n      };\r\n      //获得video摄像头区域\r\n      if (navigator.mediaDevices === undefined) {\r\n        navigator.mediaDevices = {};\r\n      }\r\n\r\n      if (navigator.mediaDevices.getUserMedia === undefined) {\r\n        navigator.mediaDevices.getUserMedia = (constraints) => {\r\n          // 首先，如果有getUserMedia的话，就获得它\r\n          var getUserMedia =\r\n            navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\r\n\r\n          // 一些浏览器根本没实现它 在catch直接调用系统相机\r\n          // if (!getUserMedia) {\r\n          //   return Promise.reject(\r\n          //     new Error(\"不支持自定义拍摄，将调用系统相机\")\r\n          //   );\r\n          // }\r\n\r\n          // 否则，为老的navigator.getUserMedia方法包裹一个Promise\r\n          return new Promise(function (resolve, reject) {\r\n            getUserMedia.call(navigator, constraints, resolve, reject);\r\n          });\r\n        };\r\n      }\r\n\r\n      navigator.mediaDevices\r\n        .getUserMedia({ audio: false, video: true })\r\n        .then((stream) => {\r\n          var video = document.querySelector(\"video\");\r\n          // 旧的浏览器可能没有srcObject\r\n          if (\"srcObject\" in video) {\r\n            video.srcObject = stream;\r\n          } else {\r\n            // 防止在新的浏览器里使用它，应为它已经不再支持了\r\n            video.src = window.URL.createObjectURL(stream);\r\n          }\r\n          video.onloadedmetadata = (e) => {\r\n            video.play();\r\n            this.showK = true\r\n            this.rate = video.videoHeight / video.videoWidth;\r\n          };\r\n        })\r\n        .catch((err) => {\r\n          return\r\n        });\r\n    },\r\n    // 点击拍照\r\n    takePhoto() {\r\n      this.showK = false;\r\n      //获得Canvas对象\r\n      let video = document.getElementById(\"video\");\r\n      let canvas = document.getElementById(\"canvas\");\r\n      let ctx = canvas.getContext(\"2d\");\r\n      var canvasWidth = window.screen.width;\r\n      var canvasHeight = canvasWidth * this.rate;\r\n      canvas.setAttribute(\"width\", canvasWidth);\r\n      canvas.setAttribute(\"height\", canvasHeight);\r\n      ctx.clearRect(0, 0, canvasWidth, canvasHeight)\r\n      ctx.drawImage(video, 0, 0, canvasWidth, canvasHeight);\r\n      this.currPhoto = canvas.toDataURL(\"image/png\");\r\n      this.isTake = true\r\n      this.$nextTick(() => {\r\n        document.getElementById(\"img\").src = this.currPhoto;\r\n      })\r\n    },\r\n    // 点击重拍\r\n    reTake() {\r\n      this.currPhoto = null\r\n      this.isTake = false\r\n      this.getMedia()\r\n    },\r\n    // 点击确定\r\n    submit() {\r\n      this.currPhoto\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n<style >\r\n#takepicture {\r\n  opacity: 0;\r\n}\r\n.tools {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  padding: 20px;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  bottom: 0;\r\n}\r\n\r\nbody {\r\n  margin: 0;\r\n}\r\n</style>\r\n<style scoped>\r\n.re_take {\r\n  border: none;\r\n  background-color: #fff;\r\n}\r\n.confirm {\r\n  background-color: #42b884;\r\n  border: none;\r\n  color: #fff;\r\n}\r\n#canvas {\r\n  display: none;\r\n}\r\n.take_phone {\r\n  position: absolute;\r\n  bottom: 20px;\r\n  right: 20px;\r\n  top: unset;\r\n  z-index: 940;\r\n}\r\nbutton {\r\n  width: 100px;\r\n  height: 30px;\r\n}\r\n.bg_black {\r\n  width: 100vw;\r\n  height: 100vh;\r\n  overflow: hidden;\r\n  background-color: black;\r\n}\r\n#video {\r\n  z-index: 100;\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 50%;\r\n  min-width: 100%;\r\n  max-width: 100%;\r\n  min-height: 100%;\r\n  max-height: 100%;\r\n  /* object-fit: cover; 这里是关键 */\r\n  width: auto;\r\n  height: auto;\r\n  -ms-transform: translateX(-50%) translateY(-50%);\r\n  -webkit-transform: translateX(-50%) translateY(-50%);\r\n  transform: translateX(-50%) translateY(-50%);\r\n  background-size: cover;\r\n}\r\n#kuan {\r\n  position: absolute;\r\n  width: 20vw;\r\n  height: 20vw;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  left: 10vw;\r\n  z-index: 9999;\r\n}\r\n.box {\r\n  position: relative;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  /* transform: rotate(90deg); */\r\n}\r\n@media screen and (orientation: portrait) {\r\n  /*竖屏 css*/\r\n  #img {\r\n    width: 100%;\r\n    object-fit: cover;\r\n  }\r\n}\r\n@media screen and (orientation: landscape) {\r\n  /*横屏 css*/\r\n  #video {\r\n    object-fit: cover;\r\n  }\r\n  #img {\r\n    height: 100%;\r\n    object-fit: cover;\r\n  }\r\n}\r\n#mb {\r\n  border: 1px solid #333;\r\n}\r\n\r\n.img_box {\r\n  display: flex;\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  align-items: center;\r\n  width: 100vw;\r\n  height: 100vh;\r\n  justify-content: center;\r\n}\r\n</style>","import { render } from \"./camera.vue?vue&type=template&id=40913e63&scoped=true\"\nimport script from \"./camera.vue?vue&type=script&lang=js\"\nexport * from \"./camera.vue?vue&type=script&lang=js\"\n\nimport \"./camera.vue?vue&type=style&index=0&id=40913e63&lang=css\"\nimport \"./camera.vue?vue&type=style&index=1&id=40913e63&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-40913e63\"\n\nexport default script","import { render } from \"./main.vue?vue&type=template&id=710c53d4&scoped=true\"\nimport script from \"./main.vue?vue&type=script&lang=js\"\nexport * from \"./main.vue?vue&type=script&lang=js\"\n\nimport \"./main.vue?vue&type=style&index=0&id=710c53d4&scoped=true&lang=css\"\nscript.render = render\nscript.__scopeId = \"data-v-710c53d4\"\n\nexport default script"],"sourceRoot":""}